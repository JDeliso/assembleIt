<!DOCTYPE html>
<html lang="en">
    <%- include('../partials/head.ejs', {title: "YOUR PROFILE"}) %>

<body>
    <!-- navbar -->
    <%- include('../partials/nav') %>

    <div class="posts">
        <div class="profile-container">
            <!-- LEFT SIDE OF THE PROFILE - SHOW POSTS -->
            <div class="profile-posts">
                <div>
                    <h4>YOUR POSTS</h4>

                    <div class='posts'>

                        <!-- If there is no post -->
                        <% if(user.posts.length === 0) { %>
                            <p> <%= user.username %> hasn't posted anything yet :(</p>
                        <% } %>

                        <!-- show newest post first -->
                        <ul>
                            <% for(let i = user.posts.length-1; i >= 0; i--){ %>
                                <li>
                                    <article>
                                        <a href="/posts/<%= user.posts[i]._id %>"> <b><%= user.posts.title %></b> </a>
                                        <br><small>Submitted on: <%= moment(user.posts[i].createdAt).startOf('hour').fromNow(); %></small>
                                    </article>
                                    <form action="/posts/<%= user.posts[i]._id%>/edit">
                                        <button type="submit" class="btn btn-link btn-sm pull-left">COMMENTS</button>
                                    </form>
                                    <form action="/posts/<%= user.posts[i]._id %>/edit">
                                        <button type="submit" class="btn btn-link btn-sm pull-left">EDIT</button>
                                    </form>
                                    <form action="/posts/<%= user.posts[i]._id %>?_method=DELETE" method="POST">
                                        <button type="submit" class="btn btn-link btn-sm pull-left">DELETE</button>
                                    </form>
                                </li>
                            <% } %>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- RIGHT SIDE OF THE PROFILE - SHOW USER INFO -->
            <div class="profile-user">
                <div>
                    <h4>PROFILE</h4>
                    <p><b>username:</b> <%= user.username %></p>
                    <p><b>karma:</b> <%= user.karma %></p>
                    <p><b>cakeday:</b> <%= moment(user.createdAt).format("MMM Do YY"); %></p>
                    <div class="profile-form">
                        <form action="/users/<%= user._id %>/edit">
                            <button type="submit" class="btn btn-link btn-sm">EDIT INFO</button>
                        </form>
                        <form action="/users/<%= user._id %>?_method=DELETE" method="POST">
                            <button type="submit" class="btn btn-link btn-sm">DELETE ACCOUNT</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- footer -->
    <%- include('../partials/footer') %>

</body>
</html>

